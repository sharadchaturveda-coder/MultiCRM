var S=Object.defineProperty;var C=(o,e,a)=>e in o?S(o,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[e]=a;var v=(o,e,a)=>(C(o,typeof e!="symbol"?e+"":e,a),a);import{r as l,a as P,B as O,b as L,d as x,R as k}from"./vendor-601c82f3.js";import{a as $,Q as A,b as D}from"./ui-7dd21468.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=a(r);fetch(r.href,s)}})();var b={exports:{}},y={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q=l,B=Symbol.for("react.element"),M=Symbol.for("react.fragment"),U=Object.prototype.hasOwnProperty,z=q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V={key:!0,ref:!0,__self:!0,__source:!0};function N(o,e,a){var n,r={},s=null,i=null;a!==void 0&&(s=""+a),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)U.call(e,n)&&!V.hasOwnProperty(n)&&(r[n]=e[n]);if(o&&o.defaultProps)for(n in e=o.defaultProps,e)r[n]===void 0&&(r[n]=e[n]);return{$$typeof:B,type:o,key:s,ref:i,props:r,_owner:z.current}}y.Fragment=M;y.jsx=N;y.jsxs=N;b.exports=y;var t=b.exports,j={},_=P;j.createRoot=_.createRoot,j.hydrateRoot=_.hydrateRoot;const F="modulepreload",Q=function(o){return"/"+o},E={},f=function(e,a,n){if(!a||a.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(a.map(s=>{if(s=Q(s),s in E)return;E[s]=!0;const i=s.endsWith(".css"),p=i?'[rel="stylesheet"]':"";if(!!n)for(let u=r.length-1;u>=0;u--){const h=r[u];if(h.href===s&&(!i||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${p}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":F,i||(d.as="script",d.crossOrigin=""),d.href=s,document.head.appendChild(d),i)return new Promise((u,h)=>{d.addEventListener("load",u),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s})};class W{constructor(){v(this,"api");v(this,"tenantId",null);this.api=$.create({baseURL:"http://localhost:3001/api",timeout:1e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>(this.tenantId&&(e.headers["x-tenant-id"]=this.tenantId),e))}setTenantId(e){this.tenantId=e}getTenantId(){return this.tenantId}async get(e,a){try{return(await this.api.get(e,a)).data}catch(n){throw this.handleError(n)}}async post(e,a,n){try{return(await this.api.post(e,a,n)).data}catch(r){throw this.handleError(r)}}async put(e,a,n){try{return(await this.api.put(e,a,n)).data}catch(r){throw this.handleError(r)}}async delete(e,a){try{return(await this.api.delete(e,a)).data}catch(n){throw this.handleError(n)}}async getTenants(e){return this.get("/tenants",{params:e})}async createTenant(e){return this.post("/tenants",e)}async getTenant(e){return this.get(`/tenants/${e}`)}async getContacts(e){return this.get("/contacts",{params:e})}async createContact(e){return this.post("/contacts",e)}async updateContact(e,a){return this.put(`/contacts/${e}`,a)}async deleteContact(e){return this.delete(`/contacts/${e}`)}handleError(e){var a,n;if(e.response){const r=((a=e.response.data)==null?void 0:a.message)||((n=e.response.data)==null?void 0:n.error)||"Server error";return new Error(`${e.response.status}: ${r}`)}else return e.request?new Error("Network error - no response from server"):new Error(e.message||"Unknown error occurred")}}const g=new W,I=l.createContext(void 0),J=()=>{const o=l.useContext(I);if(o===void 0)throw new Error("useTenant must be used within a TenantProvider");return o},K=({children:o})=>{const[e,a]=l.useState(null),[n,r]=l.useState([]),[s,i]=l.useState(!0),[p,m]=l.useState(null),d=async()=>{try{i(!0),m(null);const c=await g.getTenants();c.success&&c.data?r(c.data.data||[]):m("Failed to load tenants")}catch(c){m(c instanceof Error?c.message:"Unknown error")}finally{i(!1)}},u=c=>{a(c),g.setTenantId((c==null?void 0:c.id)||null),c?localStorage.setItem("currentTenantId",c.id):localStorage.removeItem("currentTenantId")};l.useEffect(()=>{d();const c=localStorage.getItem("currentTenantId");c&&g.setTenantId(c)},[]),l.useEffect(()=>{if(n.length>0){const c=localStorage.getItem("currentTenantId");if(c){const w=n.find(R=>R.id===c);w&&a(w)}}},[n]);const h={currentTenant:e,tenants:n,setCurrentTenant:u,loading:s,error:p,refreshTenants:d};return t.jsx(I.Provider,{value:h,children:o})},Y=()=>{const{currentTenant:o,tenants:e,setCurrentTenant:a,loading:n,error:r}=J();return n?t.jsx("header",{className:"bg-white shadow-sm border-b px-4 py-3",children:t.jsx("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"MultiCRM"}),t.jsx("div",{className:"text-sm text-gray-500",children:"Loading tenants..."})]})})}):r?t.jsx("header",{className:"bg-white shadow-sm border-b px-4 py-3",children:t.jsx("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"MultiCRM"}),t.jsxs("div",{className:"text-sm text-red-600",children:["Error: ",r]})]})})}):t.jsx("header",{className:"bg-white shadow-sm border-b px-4 py-3",children:t.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"MultiCRM"}),o?t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Tenant:"}),t.jsx("span",{className:"px-2 py-1 bg-primary-100 text-primary-800 rounded text-sm font-medium",children:o.name})]}):t.jsx("span",{className:"text-sm text-gray-500",children:"No tenant selected"})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("select",{value:(o==null?void 0:o.id)||"",onChange:s=>{const i=s.target.value,p=e.find(m=>m.id===i)||null;a(p)},className:"text-sm border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",children:[t.jsx("option",{value:"",children:"Select Tenant"}),e.map(s=>t.jsxs("option",{value:s.id,children:[s.name," (",s.domain,")"]},s.id))]}),t.jsxs("nav",{className:"flex items-center space-x-6",children:[t.jsx("a",{href:"/",className:"text-gray-500 hover:text-gray-700 text-sm font-medium",children:"Dashboard"}),t.jsx("a",{href:"/contacts",className:"text-gray-500 hover:text-gray-700 text-sm font-medium",children:"Contacts"}),t.jsx("a",{href:"/tasks",className:"text-gray-500 hover:text-gray-700 text-sm font-medium",children:"Tasks"}),t.jsx("a",{href:"/invoices",className:"text-gray-500 hover:text-gray-700 text-sm font-medium",children:"Invoices"}),t.jsx("a",{href:"/pipeline",className:"text-gray-500 hover:text-gray-700 text-sm font-medium",children:"Pipeline"})]})]})]})})};const T=l.lazy(()=>f(()=>import("./Dashboard-d5df94e9.js"),["assets/Dashboard-d5df94e9.js","assets/ui-7dd21468.js","assets/vendor-601c82f3.js","assets/charts-a43eb5bc.js"])),G=l.lazy(()=>f(()=>import("./Contacts-2f1cec33.js"),["assets/Contacts-2f1cec33.js","assets/vendor-601c82f3.js","assets/ui-7dd21468.js"])),H=l.lazy(()=>f(()=>import("./Tasks-632a0e85.js"),["assets/Tasks-632a0e85.js","assets/vendor-601c82f3.js","assets/ui-7dd21468.js"])),X=l.lazy(()=>f(()=>import("./Invoices-ba8b8c64.js"),["assets/Invoices-ba8b8c64.js","assets/vendor-601c82f3.js","assets/ui-7dd21468.js"])),Z=l.lazy(()=>f(()=>import("./Pipeline-2c2e62fa.js"),["assets/Pipeline-2c2e62fa.js","assets/vendor-601c82f3.js","assets/ui-7dd21468.js"])),ee=new A({defaultOptions:{queries:{staleTime:5*60*1e3,cacheTime:10*60*1e3}}});function te(){return t.jsx(D,{client:ee,children:t.jsx(K,{children:t.jsx(O,{children:t.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t.jsx(Y,{}),t.jsx("main",{className:"container mx-auto py-6 px-4",children:t.jsx(l.Suspense,{fallback:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}),children:t.jsxs(L,{children:[t.jsx(x,{path:"/",element:t.jsx(T,{})}),t.jsx(x,{path:"/dashboard",element:t.jsx(T,{})}),t.jsx(x,{path:"/contacts",element:t.jsx(G,{})}),t.jsx(x,{path:"/tasks",element:t.jsx(H,{})}),t.jsx(x,{path:"/invoices",element:t.jsx(X,{})}),t.jsx(x,{path:"/pipeline",element:t.jsx(Z,{})})]})})})]})})})})}j.createRoot(document.getElementById("root")).render(t.jsx(k.StrictMode,{children:t.jsx(te,{})}));export{g as a,t as j,J as u};
